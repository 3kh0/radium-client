#include "SpeedMine.h"
#include "../pch.h"

SpeedMine::SpeedMine() : IModule(0, Category::EXPLOIT, "Destroy blocks faster") {
	registerBoolSetting("Instant", &instant, instant);
	registerFloatSetting("Speed", &speed, speed, 1.f, 50.f);
	registerIntSetting("Timer", &timerboost, timerboost, 20, 80);
}

const char* SpeedMine::getModuleName() {
	return ("SpeedMine");
}

void SpeedMine::onEnable() {
}

void SpeedMine::onTick(C_GameMode* gm) {
	auto player = g_Data.getLocalPlayer();
	if (player == nullptr) return;

	// unused
	if (!g_Data.isLeftClickDown()) {
		g_Data.getClientInstance()->minecraft->setTimerSpeed(20.f);
		return;
	}


	if (g_Data.canUseMoveKeys() && !moduleMgr->getModule<ClickGUIMod>()->isEnabled()) {
		PointingStruct* pointing = g_Data.getLocalPlayer()->pointingStruct;
		if (!pointing->hasEntity()) {
			if(player->region->getBlock(pointing->block)->blockLegacy->blockId != 0) g_Data.getClientInstance()->minecraft->setTimerSpeed(timerboost);
		}
		else
		{
			g_Data.getClientInstance()->minecraft->setTimerSpeed(20.f);



		}

	}
}